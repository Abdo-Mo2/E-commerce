<section class="home">
<div class="hero grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-3 lg:gap-4 items-stretch py-2">
  <!-- Carousel -->
  <div class="carousel relative overflow-hidden mt-3 rounded-lg md:col-span-2 w-full">
    <div class="slides flex transition-transform duration-500 ease-in-out"
         [ngStyle]="{'transform': 'translateX(-' + (currentSlide * 100) + '%)'}"
         (mouseenter)="pauseAutoSlide()" 
         (mouseleave)="resumeAutoSlide()">

      <img src="/imges/Banner/slider-image-3.jpeg" alt="Banner 4" class="w-full flex-shrink-0 object-cover h-[360px]" />
      <img src="/imges/Banner/grocery-banner.png" alt="Banner 1" class="w-full flex-shrink-0 object-cover h-[360px]" />
      <img src="/imges/Banner/slider-image-1.jpeg" alt="Banner 2" class="w-full flex-shrink-0 object-cover h-[360px]" />
      <img src="/imges/Banner/slider-image-2.jpeg" alt="Banner 3" class="w-full flex-shrink-0 object-cover h-[360px]" />
      <img src="/imges/Banner/slider-image-3.jpeg" alt="Banner 4" class="w-full flex-shrink-0 object-cover h-[360px]" />
      <img src="/imges/Banner/slider-2.jpeg" alt="Banner 1" class="w-full flex-shrink-0 object-cover h-[360px]" />

    </div>

    <!-- Navigation Buttons moved under -->
    <div class="flex justify-center items-center gap-4 mt-3">
      <button (click)="prev()" 
              class="bg-black/50 text-white rounded-full w-10 h-10 flex items-center justify-center text-lg">
        ‹
      </button>
      <div class="flex gap-2">
      </div>
      <button (click)="next()" 
              class="bg-black/50 text-white rounded-full w-10 h-10 flex items-center justify-center text-lg">
        ›
      </button>
    </div>
  </div>

  <!-- Side Images (Hidden on small screens) -->
  <div class="side-images flex-col gap-3 hidden md:flex">
    <img src="/imges/Banner/slider-2.jpeg" alt="Side 1" class="p-3" />
    <img src="/imges/Banner/grocery-banner-2.jpeg" alt="Side 2" class="p-3" />
  </div>
</div>



<div class="categories my-8 px-4">
  <h2 class="mb-6 text-2xl md:text-3xl font-bold text-gray-800 text-center">Shop Popular Categories</h2>
  
  <div class="relative overflow-hidden rounded-2xl p-8 bg-white shadow-lg">
    <div class="flex gap-6 transition-transform duration-700"
         [ngStyle]="{'transform': 'translateX(-' + (categorySlide * 184) + 'px)'}"
         [style.transition]="isDraggingCategory ? 'none' : 'transform 0.6s cubic-bezier(0.4, 0, 0.2, 1)'">
      <!-- Duplicate categories for infinite effect -->
      <div *ngFor="let c of getTripleCategories()" 
           class="flex-shrink-0 text-center cursor-pointer transition-all duration-300"
           style="width:160px">
        <div class="w-36 h-36 rounded-2xl overflow-hidden border-4 border-white/20 mx-auto mb-4 shadow-lg bg-white/10 backdrop-blur-lg"
             (mouseenter)="onCategoryHover($event, true)"
             (mouseleave)="onCategoryHover($event, false)">
          <img [src]="c?.image" [alt]="c?.name" class="w-full h-full object-cover" />
        </div>
        <div class="text-base font-semibold text-black whitespace-nowrap overflow-hidden text-ellipsis drop-shadow">
          {{ c?.name }}
        </div>
      </div>
    </div>

    <!-- Navigation buttons and gradients remain unchanged -->
    <button (click)="prevCategory()" 
            class="absolute left-3 top-1/2 -translate-y-1/2 bg-white/20 text-white border-none rounded-full w-12 h-12 cursor-pointer text-xl shadow-lg z-10 backdrop-blur transition-all duration-300 flex items-center justify-center">
      ‹
    </button>
    <button (click)="nextCategory()" 
            class="absolute right-3 top-1/2 -translate-y-1/2 bg-white/20 text-white border-none rounded-full w-12 h-12 cursor-pointer text-xl shadow-lg z-10 backdrop-blur transition-all duration-300 flex items-center justify-center">
      ›
    </button>
    <div class="absolute left-0 top-0 bottom-0 w-16 bg-gradient-to-r from-indigo-500 to-transparent pointer-events-none z-5"></div>
    <div class="absolute right-0 top-0 bottom-0 w-16 bg-gradient-to-l from-purple-700 to-transparent pointer-events-none z-5"></div>
  </div>
</div>


<div class="products-section my-12 px-4">
  <h2 class="mb-8 text-3xl font-bold text-gray-800 text-center">Featured Products</h2>
  
  <div class="products-grid grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 max-w-6xl mx-auto">
    <ng-container *ngFor="let product of products">
      <a
        *ngIf="product?._id"
        [routerLink]="['/products', product._id]"
        class="product-card bg-white rounded-2xl overflow-hidden shadow-md transition-all duration-300 cursor-pointer block group relative"
      >
        <!-- Product Image -->
        <div
          class="relative overflow-hidden h-72 bg-gray-100 border border-transparent group-hover:border-main transition-colors duration-300"
        >
          <img
            [src]="product.imageCover"
            [alt]="product.title"
            class="w-full h-full object-contain transition-transform duration-700 group-hover:scale-110"
          />

          <!-- Wishlist Button -->
          <button
            class="absolute top-3 right-[-50px] opacity-0 group-hover:right-3 group-hover:opacity-100 border-none rounded-full w-9 h-9 flex items-center justify-center shadow transition-all duration-300 bg-white hover:bg-gray-100"
            (click)="$event.preventDefault(); $event.stopPropagation(); toggleWishlist(product._id)"
            aria-label="Toggle wishlist"
            title="Add to wishlist"
          >
            <span class="text-main text-xl" *ngIf="!isInWishlist(product._id)">♡</span>
            <span class="text-main text-xl" *ngIf="isInWishlist(product._id)">♥</span>
          </button>
        </div>

        <!-- Product Info -->
        <div class="p-5 bg-gray-50">
          <span
            *ngIf="product?.category"
            class="text-sm text-main font-semibold mb-2 leading-tight h-11 overflow-hidden line-clamp-2 block"
          >
            {{ product?.category?.name }}
          </span>
          <h3 class="text-base font-semibold text-gray-900 mb-2 leading-tight h-11 overflow-hidden line-clamp-2">
            {{ product.title }}
          </h3>

          <!-- Rating -->
          <div class="flex items-center gap-1 mb-3">
            <div class="flex gap-px">
              <span
                *ngFor="let star of [1,2,3,4,5]"
                [ngClass]="star <= product.ratingsAverage ? 'text-yellow-400' : 'text-gray-200'"
                class="text-sm"
                >★</span
              >
            </div>
            <span class="text-xs text-gray-400 ml-1">({{ product.ratingsQuantity }})</span>
          </div>

          <!-- Price -->
          <div class="flex items-center justify-between mb-4">
            <span class="text-lg font-bold text-green-600">
              {{ product.price | currency:'EGP':'symbol':'1.0-0' }}
            </span>
            <span *ngIf="product.priceAfterDiscount" class="text-sm text-gray-400 line-through">
              {{ product.priceAfterDiscount | currency:'EGP':'symbol':'1.0-0' }}
            </span>
          </div>
        </div>

        <!-- Add to Cart Button -->
        <button
          (click)="$event.preventDefault(); $event.stopPropagation(); addToCart(product)"
          class="w-full h-11 gap-2 rounded-lg bg-main text-white font-semibold text-sm shadow hover:bg-main2 transition-all duration-300"
        >
          Add to Cart
        </button>
      </a>
    </ng-container>
  </div>
</div>

</section>
